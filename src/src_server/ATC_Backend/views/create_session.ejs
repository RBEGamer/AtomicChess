<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/landing-page.css" rel="stylesheet">
    <link href="/css/lightbox.min.css" rel="stylesheet">
    <link href="/css/photo_gallery.css" rel="stylesheet">
    <link href="/ionicons/css/ionicons.min.css" rel="stylesheet">
    <link href="/css/faq.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="AtomicChess">
    <meta name="author" content="Marcel Ochsendorf">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <link href="/css/dashboard_main.css" rel="stylesheet">
    <link href="/css/dashboard_cards.css" rel="stylesheet">
    <link rel="stylesheet" href="/js/PGNViewer/css/pgnvjs.css">
    <link href="/css/font-awesome.min.css" rel="stylesheet">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="AtomicChess">
    <meta name="author" content="Marcel Ochsendorf">
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <title>ATC BACKEND - API LOGIN</title>

    <style>
        .key {
            color: rgba(3, 161, 43, 0.74);
        }

        .boolean {
            color: rgb(0, 81, 255);
            font-weight: bold;
        }

        .string {
            color: rgb(202, 4, 47);
        }

        .null {
            color: rgb(2, 0, 0);
            font-weight: bold;
        }

        .number {
            color: rgb(0, 255, 21);
        }
    </style>


</head>

<body class="container">

<nav class="navbar navbar-expand-lg navbar-light bg-light">

    <a class="navbar-brand" href="/"><img width="64px"  src="/img/icons/chess_icon.png"><b>AtomicChess -  PLAYER CONFIGURATION</b></a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" id="" href="/">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="" href="/statistics">Statistics</a>
            </li>
        </ul>
    </div>
</nav>


<div id="alert_message"></div>


<div class="row justify-content-center">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title text-justify">PLEASE LOGIN</h4>
            </div>
            <div class="card-body">
                <div class="text-center">

<form method="post" action="/rest/perform_user_login">
                        <div class="form-group row">
                            <label for="inputPassword" class="col-sm-2 col-form-label">PASSWORD</label>
                            <div class="col-sm-10">
                                <input type="password" class="form-control" id="user_pw" name="user_pw" placeholder="">
                            </div>
                            <input type="hidden" id="origin_url" name="origin_url" value="" />
                            <button type="submit" class="btn btn-fh">LOGIN</button>
                        </div>
</form>

                </div>
            </div>
        </div>
    </div>
</div>











<script src="/js/jquery/jquery.min.js"></script>
<script src="/bootstrap/js/bootstrap.min.js"></script>
<script src="/js/PGNViewer/js/pgnvjs.js"></script>


<script>


    //PARSES THE QUERY STRING IN THE URL
    //https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript
    function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    function check_login_state(_orgin){
        $.getJSON('/rest/check_login_state',function (data) {
            console.log(data);
            if(data && data.login_state== null || data.login_state === false){

                if(String(_orgin).includes("/create_session?origin=")){
                    window.location.href = _orgin;
                }

            }
        });
    }


    //EXECUTES SCRIPT IF PAGE LOADED
    $(document).ready(function () {

        var tmp = getParameterByName('origin');
        // console.log(tmp);
        if(tmp != null && tmp != ""){
            check_login_state(tmp);
            $("#origin_url").val(tmp);
        }else{
            check_login_state("/");
        }
    });
</script>
</body>
</html>